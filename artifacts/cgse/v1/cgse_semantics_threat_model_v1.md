# CGSE Semantics Boundary Threat Model

- artifact id: `cgse-semantics-threat-model-v1`
- generated at (utc): `2026-02-18T06:42:15Z`
- baseline comparator: `legacy_networkx_code/networkx/networkx (repository checkout in current workspace)`
- source ledger: `artifacts/cgse/v1/cgse_legacy_tiebreak_ordering_ledger_v1.json`
- source policy: `artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json`

## Scope
Threat model for CGSE semantics boundaries with explicit strict/hardened compatibility envelopes.

## Packet Threat Matrix
| threat id | rule id | threat class | strict mode response | hardened mode response | mitigations | evidence artifact | adversarial hooks | crash taxonomy | allowlist | compatibility boundary |
|---|---|---|---|---|---|---|---|---|---|---|
| CGSE-TM-R01 | CGSE-R01 | state_corruption | Fail-closed on any strict-mode drift from `first-unused-integer key scan` / `stable for fixed keydict state; gaps may be skipped after deletions` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R01 | cgse.graph_core_mutation.strict_drift_detected; cgse.graph_core_mutation.hardened_allowlist_violation | CGSE-AMB-001 | graph_core_mutation semantics boundary for CGSE-R01 |
| CGSE-TM-R02 | CGSE-R02 | state_corruption | Fail-closed on any strict-mode drift from `remove newest edge first when key=None` / `LIFO across multiedges between same endpoints` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R02 | cgse.graph_core_mutation.strict_drift_detected; cgse.graph_core_mutation.hardened_allowlist_violation | CGSE-AMB-002 | graph_core_mutation semantics boundary for CGSE-R02 |
| CGSE-TM-R03 | CGSE-R03 | state_corruption | Fail-closed on any strict-mode drift from `preserve encounter-order attr selection` / `directed edge traversal order determines conflict winner` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R03 | cgse.graph_core_mutation.strict_drift_detected; cgse.graph_core_mutation.hardened_allowlist_violation | CGSE-AMB-003 | graph_core_mutation semantics boundary for CGSE-R03 |
| CGSE-TM-R04 | CGSE-R04 | ordering_ambiguity | Fail-closed on any strict-mode drift from `prefer direct dict-order surfaces; treat set-union surfaces as ambiguity hotspots` / `deterministic for pure dict proxies; ambiguous for set-union composites` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R04 | cgse.view_semantics.strict_drift_detected; cgse.view_semantics.hardened_allowlist_violation | CGSE-AMB-004 | view_semantics semantics boundary for CGSE-R04 |
| CGSE-TM-R05 | CGSE-R05 | backend_route_ambiguity | Fail-closed on any strict-mode drift from `sorted-key application for unknown priority categories` / `stable env-variable fold order after normalization` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R05 | cgse.dispatch_routing.strict_drift_detected; cgse.dispatch_routing.hardened_allowlist_violation | CGSE-AMB-005 | dispatch_routing semantics boundary for CGSE-R05 |
| CGSE-TM-R06 | CGSE-R06 | backend_route_ambiguity | Fail-closed on any strict-mode drift from `grouped-priority try-order with no implicit alphabetical fallback for ambiguous group3` / `group1 -> group2 -> group3 -> group4 -> group5` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R06 | cgse.dispatch_routing.strict_drift_detected; cgse.dispatch_routing.hardened_allowlist_violation | CGSE-AMB-006 | dispatch_routing semantics boundary for CGSE-R06 |
| CGSE-TM-R07 | CGSE-R07 | conversion_precedence_drift | Fail-closed on any strict-mode drift from `fixed probe-order precedence` / `first successful conversion branch wins` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R07 | cgse.conversion_contracts.strict_drift_detected; cgse.conversion_contracts.hardened_allowlist_violation | CGSE-AMB-007 | conversion_contracts semantics boundary for CGSE-R07 |
| CGSE-TM-R08 | CGSE-R08 | tie_break_ambiguity | Fail-closed on any strict-mode drift from `distance then insertion counter then predecessor-list first element` / `equal-weight predecessors tracked in encounter order` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R08 | cgse.shortest_path_algorithms.strict_drift_detected; cgse.shortest_path_algorithms.hardened_allowlist_violation | CGSE-AMB-008 | shortest_path_algorithms semantics boundary for CGSE-R08 |
| CGSE-TM-R09 | CGSE-R09 | tie_break_ambiguity | Fail-closed on any strict-mode drift from `alternating direction + monotonic fringe counter` / `first discovered best meet-node wins unless shorter path found` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R09 | cgse.shortest_path_algorithms.strict_drift_detected; cgse.shortest_path_algorithms.hardened_allowlist_violation | bounded_diagnostic_enrichment | shortest_path_algorithms semantics boundary for CGSE-R09 |
| CGSE-TM-R10 | CGSE-R10 | serialization_order_drift | Fail-closed on any strict-mode drift from `graph-edge iteration order` / `output row order follows edge iterator traversal` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R10 | cgse.readwrite_serialization.strict_drift_detected; cgse.readwrite_serialization.hardened_allowlist_violation | CGSE-AMB-009 | readwrite_serialization semantics boundary for CGSE-R10 |
| CGSE-TM-R11 | CGSE-R11 | serialization_order_drift | Fail-closed on any strict-mode drift from `first-seen line order for duplicate/same-endpoint edges` / `edge insertion order matches parsed line order` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R11 | cgse.readwrite_serialization.strict_drift_detected; cgse.readwrite_serialization.hardened_allowlist_violation | bounded_diagnostic_enrichment | readwrite_serialization semantics boundary for CGSE-R11 |
| CGSE-TM-R12 | CGSE-R12 | generator_order_drift | Fail-closed on any strict-mode drift from `input-iterable order and documented directed orientation` / `generator edge emission follows pairwise traversal` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R12 | cgse.generator_semantics.strict_drift_detected; cgse.generator_semantics.hardened_allowlist_violation | CGSE-AMB-010 | generator_semantics semantics boundary for CGSE-R12 |
| CGSE-TM-R13 | CGSE-R13 | config_validation_order_drift | Fail-closed on any strict-mode drift from `deterministic sorted error-report ordering` / `stable validation message ordering across runs` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R13 | cgse.runtime_config.strict_drift_detected; cgse.runtime_config.hardened_allowlist_violation | bounded_diagnostic_enrichment | runtime_config semantics boundary for CGSE-R13 |
| CGSE-TM-R14 | CGSE-R14 | oracle_ambiguity_mismatch | Fail-closed on any strict-mode drift from `accept multiple equivalent predecessor orderings where legacy oracle permits` / `maintain compatibility allowlist for equal-cost ambiguity` semantics. | Allow only explicit allowlisted ambiguity categories with deterministic audit evidence; otherwise fail closed. | machine-checkable strict/hardened invariants per policy row; allowlist-bound ambiguity control gates; cross-channel replayable verification hook coverage | artifacts/cgse/v1/cgse_deterministic_policy_spec_v1.json | CGSE-DIFF-R14 | cgse.oracle_test_surface.strict_drift_detected; cgse.oracle_test_surface.hardened_allowlist_violation | CGSE-AMB-011 | oracle_test_surface semantics boundary for CGSE-R14 |

## Compatibility Boundary Matrix
| boundary id | rule id | strict parity obligation | hardened allowlisted categories | fail-closed default | evidence hooks |
|---|---|---|---|---|---|
| CGSE-CB-R01 | CGSE-R01 | Preserve legacy-observable tie-break `first-unused-integer key scan` and ordering `stable for fixed keydict state; gaps may be skipped after deletions` contracts without repair heuristics. | CGSE-AMB-001 | fail_closed_on_cgse_r01_drift | legacy_networkx_code/networkx/networkx/classes/tests/test_multigraph.py:320-362; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/graph_core_mutation_hardened.json:1-200; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R02 | CGSE-R02 | Preserve legacy-observable tie-break `remove newest edge first when key=None` and ordering `LIFO across multiedges between same endpoints` contracts without repair heuristics. | CGSE-AMB-002 | fail_closed_on_cgse_r02_drift | legacy_networkx_code/networkx/networkx/classes/tests/test_multigraph.py:363-406; legacy_networkx_code/networkx/networkx/classes/tests/test_multidigraph.py:329-392; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/graph_core_mutation_hardened.json:1-200; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R03 | CGSE-R03 | Preserve legacy-observable tie-break `preserve encounter-order attr selection` and ordering `directed edge traversal order determines conflict winner` contracts without repair heuristics. | CGSE-AMB-003 | fail_closed_on_cgse_r03_drift | legacy_networkx_code/networkx/networkx/classes/tests/test_digraph.py:101-123; legacy_networkx_code/networkx/networkx/classes/tests/test_multidigraph.py:223-244; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/graph_core_shortest_path_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R04 | CGSE-R04 | Preserve legacy-observable tie-break `prefer direct dict-order surfaces; treat set-union surfaces as ambiguity hotspots` and ordering `deterministic for pure dict proxies; ambiguous for set-union composites` contracts without repair heuristics. | CGSE-AMB-004 | fail_closed_on_cgse_r04_drift | legacy_networkx_code/networkx/networkx/classes/tests/test_coreviews.py:26-81; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/view_neighbors_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R05 | CGSE-R05 | Preserve legacy-observable tie-break `sorted-key application for unknown priority categories` and ordering `stable env-variable fold order after normalization` contracts without repair heuristics. | CGSE-AMB-005 | fail_closed_on_cgse_r05_drift | legacy_networkx_code/networkx/networkx/utils/tests/test_backends.py:217-218; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/dispatch_route_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R06 | CGSE-R06 | Preserve legacy-observable tie-break `grouped-priority try-order with no implicit alphabetical fallback for ambiguous group3` and ordering `group1 -> group2 -> group3 -> group4 -> group5` contracts without repair heuristics. | CGSE-AMB-006 | fail_closed_on_cgse_r06_drift | legacy_networkx_code/networkx/networkx/utils/tests/test_backends.py:136-158; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/dispatch_route_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R07 | CGSE-R07 | Preserve legacy-observable tie-break `fixed probe-order precedence` and ordering `first successful conversion branch wins` contracts without repair heuristics. | CGSE-AMB-007 | fail_closed_on_cgse_r07_drift | legacy_networkx_code/networkx/networkx/tests/test_convert.py:21-31; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/convert_edge_list_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R08 | CGSE-R08 | Preserve legacy-observable tie-break `distance then insertion counter then predecessor-list first element` and ordering `equal-weight predecessors tracked in encounter order` contracts without repair heuristics. | CGSE-AMB-008 | fail_closed_on_cgse_r08_drift | legacy_networkx_code/networkx/networkx/algorithms/shortest_paths/tests/test_weighted.py:271-286; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/graph_core_shortest_path_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R09 | CGSE-R09 | Preserve legacy-observable tie-break `alternating direction + monotonic fringe counter` and ordering `first discovered best meet-node wins unless shorter path found` contracts without repair heuristics. | bounded_diagnostic_enrichment | fail_closed_on_cgse_r09_drift | legacy_networkx_code/networkx/networkx/algorithms/shortest_paths/tests/test_weighted.py:165-182; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/graph_core_shortest_path_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R10 | CGSE-R10 | Preserve legacy-observable tie-break `graph-edge iteration order` and ordering `output row order follows edge iterator traversal` contracts without repair heuristics. | CGSE-AMB-009 | fail_closed_on_cgse_r10_drift | legacy_networkx_code/networkx/networkx/readwrite/tests/test_edgelist.py:187-217; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/readwrite_roundtrip_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R11 | CGSE-R11 | Preserve legacy-observable tie-break `first-seen line order for duplicate/same-endpoint edges` and ordering `edge insertion order matches parsed line order` contracts without repair heuristics. | bounded_diagnostic_enrichment | fail_closed_on_cgse_r11_drift | legacy_networkx_code/networkx/networkx/readwrite/tests/test_edgelist.py:117-170; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/readwrite_json_roundtrip_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R12 | CGSE-R12 | Preserve legacy-observable tie-break `input-iterable order and documented directed orientation` and ordering `generator edge emission follows pairwise traversal` contracts without repair heuristics. | CGSE-AMB-010 | fail_closed_on_cgse_r12_drift | legacy_networkx_code/networkx/networkx/generators/tests/test_classic.py:212-232; legacy_networkx_code/networkx/networkx/generators/tests/test_classic.py:409-442; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/generators_cycle_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R13 | CGSE-R13 | Preserve legacy-observable tie-break `deterministic sorted error-report ordering` and ordering `stable validation message ordering across runs` contracts without repair heuristics. | bounded_diagnostic_enrichment | fail_closed_on_cgse_r13_drift | legacy_networkx_code/networkx/networkx/utils/tests/test_config.py:120-169; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/runtime_config_optional_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |
| CGSE-CB-R14 | CGSE-R14 | Preserve legacy-observable tie-break `accept multiple equivalent predecessor orderings where legacy oracle permits` and ordering `maintain compatibility allowlist for equal-cost ambiguity` contracts without repair heuristics. | CGSE-AMB-011 | fail_closed_on_cgse_r14_drift | legacy_networkx_code/networkx/networkx/algorithms/shortest_paths/tests/test_weighted.py:271-286; crates/fnx-conformance/tests/phase2c_packet_readiness_gate.rs:51-187; crates/fnx-conformance/fixtures/generated/conformance_harness_strict.json:1-220; scripts/run_phase2c_readiness_e2e.sh:1-120 |

## Hardened Guardrails
- allowlisted categories only: `CGSE-AMB-001; CGSE-AMB-002; CGSE-AMB-003; CGSE-AMB-004; CGSE-AMB-005; CGSE-AMB-006; CGSE-AMB-007; CGSE-AMB-008; CGSE-AMB-009; CGSE-AMB-010; CGSE-AMB-011; bounded_diagnostic_enrichment`.
- ad hoc hardened deviations: forbidden.
- unknown incompatible feature policy: fail_closed.
