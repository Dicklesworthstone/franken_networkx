{
  "schema_version": "1.0.0",
  "contract_id": "fnx-phase2c-security-compat-contract-v1",
  "generated_at_utc": "2026-02-13T20:23:00Z",
  "categories": [
    {
      "category": "bounded_diagnostic_enrichment",
      "description": "Adds deterministic bounded diagnostics while keeping outward API contract unchanged.",
      "strict_mode_allowed": false,
      "hardened_mode_allowed": true
    },
    {
      "category": "defensive_parse_recovery",
      "description": "Performs bounded parse recovery attempts before fail-closed decision.",
      "strict_mode_allowed": false,
      "hardened_mode_allowed": true
    },
    {
      "category": "bounded_resource_clamp",
      "description": "Applies explicit time/memory/input clamps with deterministic reject path.",
      "strict_mode_allowed": false,
      "hardened_mode_allowed": true
    },
    {
      "category": "deterministic_backend_fallback_with_audit",
      "description": "Allows deterministic fallback backend route only when explicitly allowlisted and audited.",
      "strict_mode_allowed": false,
      "hardened_mode_allowed": true
    },
    {
      "category": "deterministic_tie_break_normalization",
      "description": "Allows deterministic normalization of tie-break internals while preserving observable output contract.",
      "strict_mode_allowed": false,
      "hardened_mode_allowed": true
    },
    {
      "category": "quarantine_of_unsupported_metadata",
      "description": "Quarantines unsupported metadata and fails closed if compatibility impact cannot be proven safe.",
      "strict_mode_allowed": false,
      "hardened_mode_allowed": true
    }
  ],
  "packet_allowlist": [
    {
      "packet_id": "FNX-P2C-001",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "bounded_resource_clamp"
      ],
      "notes": "Graph-core hardened path allows bounded diagnostics and resource clamps only."
    },
    {
      "packet_id": "FNX-P2C-002",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "quarantine_of_unsupported_metadata"
      ],
      "notes": "View-layer hardened path may quarantine unsupported metadata; no strict-mode deviation."
    },
    {
      "packet_id": "FNX-P2C-003",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "bounded_resource_clamp",
        "deterministic_backend_fallback_with_audit",
        "quarantine_of_unsupported_metadata"
      ],
      "notes": "Dispatch hardened mode permits deterministic fallback only with explicit audit evidence.",
      "fail_closed_default": "unknown_incompatible_feature",
      "threat_taxonomy": [
        "parser_abuse",
        "metadata_ambiguity",
        "version_skew",
        "resource_exhaustion",
        "state_corruption",
        "backend_route_ambiguity",
        "policy_bypass"
      ],
      "compatibility_boundary_matrix": [
        {
          "boundary_id": "P2C003-CB-1",
          "strict_parity_obligation": "Backend override and selection remain deterministic and parity-preserving.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "deterministic_backend_fallback_with_audit"
          ],
          "fail_closed_default": "fail_closed_on_unknown_or_unsupported_backend",
          "evidence_hooks": [
            "networkx/utils/tests/test_backends.py:44-95",
            "artifacts/phase2c/FNX-P2C-003/contract_table.md#input-contract"
          ]
        },
        {
          "boundary_id": "P2C003-CB-2",
          "strict_parity_obligation": "Unsupported metadata never changes observable route identity.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "quarantine_of_unsupported_metadata"
          ],
          "fail_closed_default": "fail_closed_on_unproven_metadata_safety",
          "evidence_hooks": [
            "networkx/utils/tests/test_backends.py:135-160",
            "artifacts/phase2c/FNX-P2C-003/risk_note.md#packet-threat-matrix"
          ]
        },
        {
          "boundary_id": "P2C003-CB-3",
          "strict_parity_obligation": "Unsupported backend API envelopes are rejected with deterministic errors.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment"
          ],
          "fail_closed_default": "fail_closed_on_version_skew",
          "evidence_hooks": [
            "networkx/utils/tests/test_config.py:120-170",
            "artifacts/phase2c/FNX-P2C-003/parity_gate.yaml"
          ]
        },
        {
          "boundary_id": "P2C003-CB-4",
          "strict_parity_obligation": "Dispatch search does not exceed strict complexity budgets.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "bounded_resource_clamp"
          ],
          "fail_closed_default": "fail_closed_when_budget_exhausted",
          "evidence_hooks": [
            "artifacts/phase2c/FNX-P2C-003/parity_gate.yaml",
            "artifacts/perf/phase2c/perf_regression_gate_report_v1.json"
          ]
        },
        {
          "boundary_id": "P2C003-CB-5",
          "strict_parity_obligation": "Dispatch cache semantics remain deterministic and replayable.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment"
          ],
          "fail_closed_default": "fail_closed_on_cache_invariant_break",
          "evidence_hooks": [
            "networkx/classes/tests/dispatch_interface.py:186-190",
            "artifacts/phase2c/FNX-P2C-003/contract_table.md#machine-checkable-invariant-matrix"
          ]
        },
        {
          "boundary_id": "P2C003-CB-6",
          "strict_parity_obligation": "Unknown incompatible feature paths fail closed with no implicit repair.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment"
          ],
          "fail_closed_default": "fail_closed_on_unknown_incompatible_feature",
          "evidence_hooks": [
            "networkx/utils/tests/test_backends.py:162-168",
            "artifacts/phase2c/FNX-P2C-003/risk_note.md#compatibility-boundary-matrix"
          ]
        }
      ]
    },
    {
      "packet_id": "FNX-P2C-004",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "defensive_parse_recovery",
        "bounded_resource_clamp",
        "deterministic_tie_break_normalization",
        "quarantine_of_unsupported_metadata"
      ],
      "notes": "Conversion/relabel hardened mode allows bounded parse recovery, deterministic tie-break normalization, and metadata quarantine with explicit audit evidence.",
      "fail_closed_default": "unknown_incompatible_feature",
      "threat_taxonomy": [
        "parser_abuse",
        "metadata_ambiguity",
        "version_skew",
        "resource_exhaustion",
        "state_corruption",
        "attribute_confusion"
      ],
      "compatibility_boundary_matrix": [
        {
          "boundary_id": "P2C004-CB-1",
          "strict_parity_obligation": "Malformed conversion payloads never yield repaired outputs in strict mode.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "defensive_parse_recovery"
          ],
          "fail_closed_default": "fail_closed_on_malformed_conversion_payload",
          "evidence_hooks": [
            "networkx/tests/test_convert.py:45-69",
            "artifacts/phase2c/FNX-P2C-004/risk_note.md#packet-threat-matrix"
          ]
        },
        {
          "boundary_id": "P2C004-CB-2",
          "strict_parity_obligation": "Attribute metadata precedence remains deterministic and parity-preserving.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "quarantine_of_unsupported_metadata"
          ],
          "fail_closed_default": "fail_closed_on_ambiguous_metadata",
          "evidence_hooks": [
            "networkx/tests/test_convert.py:134-210",
            "artifacts/phase2c/FNX-P2C-004/contract_table.md#input-contract"
          ]
        },
        {
          "boundary_id": "P2C004-CB-3",
          "strict_parity_obligation": "Unsupported schema/version envelopes are rejected deterministically.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment"
          ],
          "fail_closed_default": "fail_closed_on_version_skew",
          "evidence_hooks": [
            "networkx/tests/test_convert.py:45-69",
            "artifacts/phase2c/FNX-P2C-004/parity_gate.yaml"
          ]
        },
        {
          "boundary_id": "P2C004-CB-4",
          "strict_parity_obligation": "Conversion expansion must stay within strict complexity budgets.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "bounded_resource_clamp"
          ],
          "fail_closed_default": "fail_closed_when_conversion_budget_exhausted",
          "evidence_hooks": [
            "artifacts/phase2c/FNX-P2C-004/parity_gate.yaml",
            "artifacts/perf/phase2c/perf_regression_gate_report_v1.json"
          ]
        },
        {
          "boundary_id": "P2C004-CB-5",
          "strict_parity_obligation": "Conversion transaction boundaries preserve graph-state invariants exactly.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment"
          ],
          "fail_closed_default": "fail_closed_on_conversion_state_invariant_break",
          "evidence_hooks": [
            "networkx/tests/test_relabel.py:208-317",
            "artifacts/phase2c/FNX-P2C-004/contract_table.md#machine-checkable-invariant-matrix"
          ]
        },
        {
          "boundary_id": "P2C004-CB-6",
          "strict_parity_obligation": "Attribute namespace conflicts fail closed without hidden key rewrites.",
          "hardened_allowlisted_deviation_categories": [
            "bounded_diagnostic_enrichment",
            "deterministic_tie_break_normalization"
          ],
          "fail_closed_default": "fail_closed_on_attribute_namespace_conflict",
          "evidence_hooks": [
            "networkx/tests/test_relabel.py:296-310",
            "artifacts/phase2c/FNX-P2C-004/risk_note.md#compatibility-boundary-matrix"
          ]
        }
      ]
    },
    {
      "packet_id": "FNX-P2C-005",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "bounded_resource_clamp",
        "deterministic_tie_break_normalization"
      ],
      "notes": "Shortest-path hardened mode may clamp hostile workloads and normalize internal tie-break mechanics deterministically."
    },
    {
      "packet_id": "FNX-P2C-006",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "defensive_parse_recovery",
        "quarantine_of_unsupported_metadata"
      ],
      "notes": "Read/write hardened mode permits bounded parse recovery and metadata quarantine."
    },
    {
      "packet_id": "FNX-P2C-007",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "bounded_resource_clamp"
      ],
      "notes": "Generator hardened mode allows bounded parameter/resource clamps."
    },
    {
      "packet_id": "FNX-P2C-008",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "deterministic_backend_fallback_with_audit",
        "quarantine_of_unsupported_metadata"
      ],
      "notes": "Runtime hardened mode may fall back deterministically for allowlisted dependency routes."
    },
    {
      "packet_id": "FNX-P2C-009",
      "allowed_categories": [
        "bounded_diagnostic_enrichment",
        "deterministic_tie_break_normalization"
      ],
      "notes": "Conformance hardened mode permits deterministic comparator normalization and bounded diagnostics."
    }
  ]
}
