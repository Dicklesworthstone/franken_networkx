{
  "schema_version": "1.0.0",
  "packet_id": "FNX-P2C-002",
  "fixture_ids": [
    "generated/view_neighbors_strict.json"
  ],
  "oracle_source": "legacy_networkx",
  "generated_at_utc": "2026-02-14T06:40:00Z",
  "legacy_paths": [
    "networkx/classes/coreviews.py",
    "networkx/classes/graphviews.py"
  ],
  "legacy_symbols": [
    "AtlasView",
    "AdjacencyView",
    "generic_graph_view",
    "subgraph_view",
    "reverse_view"
  ],
  "graph_mutation_contract": "Primary graph mutation invariants enforced when packet touches graph state.",
  "view_cache_contract": "View cache coherence must remain deterministic and revision-safe.",
  "dispatch_backend_contract": "Backend routing must be deterministic and fail-closed on unknown incompatibility.",
  "conversion_readwrite_contract": "Conversion and serialization outputs preserve scoped legacy semantics.",
  "error_contract": "Strict fail-closed; hardened bounded defensive handling with audit.",
  "strict_mode_policy": "Exact NetworkX-observable behavior for scoped APIs.",
  "hardened_mode_policy": "Preserve API contract with bounded defensive controls and deterministic recovery evidence.",
  "contract_rows": [
    "FNX-P2C-002-C1",
    "FNX-P2C-002-C2",
    "FNX-P2C-002-C3",
    "FNX-P2C-002-C4",
    "FNX-P2C-002-C5"
  ],
  "machine_checkable_invariants": [
    "FNX-P2C-002-I1",
    "FNX-P2C-002-I2",
    "FNX-P2C-002-I3"
  ],
  "unknown_metadata_fail_closed_default": true,
  "hardened_allowlist": [
    {
      "divergence_class": "stale_cache_exposure",
      "strict_behavior": "fail_closed",
      "hardened_behavior": "invalidate_cache_then_recompute_once",
      "budget": "max_1_retry"
    },
    {
      "divergence_class": "projection_filter_nondeterminism",
      "strict_behavior": "fail_closed",
      "hardened_behavior": "canonicalize_filter_order_once",
      "budget": "max_1_pass"
    },
    {
      "divergence_class": "malformed_known_safe_metadata_encoding",
      "strict_behavior": "fail_closed",
      "hardened_behavior": "normalize_known_safe_encoding_once",
      "budget": "max_1_coercion"
    }
  ],
  "runtime_decision_contract": {
    "states": [
      "allow",
      "full_validate",
      "fail_closed"
    ],
    "actions": [
      "allow",
      "full_validate",
      "fail_closed"
    ],
    "loss_model": "minimize compatibility drift + security risk under deterministic constraints",
    "safe_mode_fallback": "fail_closed",
    "fallback_thresholds": {
      "unknown_incompatible_feature": true,
      "risk_probability_full_validate_min": 0.25,
      "strict_violation_count_max": 0
    }
  },
  "alien_uplift_contract_card": {
    "ev_score": 2.4,
    "baseline_comparator": "legacy_networkx/main@python3.12",
    "optimization_lever": "single-pass cache invalidation scan with stable ordering",
    "decision_hypothesis": "Apply exactly one optimization lever after profiling and retain only if behavior-isomorphic."
  },
  "excluded_scope": [
    "out-of-scope upstream API families not yet activated for this packet",
    "unsafe non-clean-room implementation techniques"
  ],
  "oracle_tests": [
    "networkx/classes/tests/test_coreviews.py",
    "networkx/classes/tests/test_graphviews.py"
  ],
  "performance_sentinels": [
    "artifacts/perf/BASELINE_BFS_V1.md",
    "artifacts/perf/phase2c/bfs_neighbor_iter_delta.json"
  ],
  "performance_profile": {
    "baseline": "artifacts/perf/BASELINE_BFS_V1.md",
    "hotspot_matrix": "artifacts/perf/OPPORTUNITY_MATRIX.md",
    "delta": "artifacts/perf/phase2c/bfs_neighbor_iter_delta.json",
    "optimization_lever_count_per_change": 1
  },
  "structured_logging_contract": {
    "fixture_report": "artifacts/conformance/latest/generated_view_neighbors_strict_json.report.json",
    "replay_command_field": "replay_command",
    "forensics_schema_matrix": "artifacts/conformance/latest/telemetry_dependent_unblock_matrix_v1.json",
    "normalization_report": "artifacts/conformance/latest/structured_log_emitter_normalization_report.json",
    "run_log_bundle": "artifacts/conformance/latest/structured_logs.jsonl"
  },
  "security_contract_refs": {
    "threat_matrix": "artifacts/phase2c/security/v1/security_compatibility_threat_matrix_v1.json",
    "hardened_allowlist": "artifacts/phase2c/security/v1/hardened_mode_deviation_allowlist_v1.json",
    "adversarial_manifest": "artifacts/phase2c/security/v1/adversarial_corpus_manifest_v1.json",
    "adversarial_seed_ledger": "artifacts/phase2c/security/v1/adversarial_seed_ledger_v1.json",
    "crash_triage_report": "artifacts/phase2c/latest/adversarial_crash_triage_report_v1.json",
    "crash_triage_events": "artifacts/phase2c/latest/adversarial_crash_triage_events_v1.jsonl",
    "regression_promotion_queue": "artifacts/phase2c/latest/adversarial_regression_promotion_queue_v1.json"
  },
  "required_threat_classes": [
    "parser_abuse",
    "metadata_ambiguity",
    "version_skew",
    "resource_exhaustion",
    "state_corruption"
  ],
  "packet_allowlisted_hardened_categories": [
    "bounded_diagnostic_enrichment",
    "quarantine_of_unsupported_metadata"
  ],
  "compatibility_boundary_matrix": [
    {
      "boundary": "parser",
      "strict_mode_obligation": "fail_closed_malformed_payload",
      "hardened_allowlisted_deviation": "bounded_diagnostic_enrichment",
      "unknown_feature_default": "fail_closed"
    },
    {
      "boundary": "metadata",
      "strict_mode_obligation": "fail_closed_ambiguous_metadata",
      "hardened_allowlisted_deviation": "quarantine_of_unsupported_metadata",
      "unknown_feature_default": "fail_closed"
    },
    {
      "boundary": "version",
      "strict_mode_obligation": "fail_closed_version_skew",
      "hardened_allowlisted_deviation": "bounded_diagnostic_enrichment",
      "unknown_feature_default": "fail_closed"
    },
    {
      "boundary": "resource",
      "strict_mode_obligation": "fail_closed_budget_exceeded",
      "hardened_allowlisted_deviation": "none_for_packet_002",
      "unknown_feature_default": "fail_closed"
    },
    {
      "boundary": "state",
      "strict_mode_obligation": "fail_closed_invariant_break",
      "hardened_allowlisted_deviation": "bounded_diagnostic_enrichment",
      "unknown_feature_default": "fail_closed"
    }
  ],
  "packet_threat_mappings": [
    {
      "threat_class": "parser_abuse",
      "validation_gate": "view-layer-threat-gate",
      "generator_variant": "view_input_malformed_payload",
      "seed": 1102,
      "expected_failure_mode": "fail_closed_malformed_payload",
      "replay_command": "python3 scripts/run_adversarial_seed_harness.py --threat-class parser_abuse --packet-id FNX-P2C-002 --run-id replay-61f3ffae5aa15245",
      "triage_routing_policy": "bug"
    },
    {
      "threat_class": "metadata_ambiguity",
      "validation_gate": "view-layer-threat-gate",
      "generator_variant": "view_conflicting_projection_metadata",
      "seed": 2102,
      "expected_failure_mode": "fail_closed_ambiguous_metadata",
      "replay_command": "python3 scripts/run_adversarial_seed_harness.py --threat-class metadata_ambiguity --packet-id FNX-P2C-002 --run-id replay-ff75380056537eaa",
      "triage_routing_policy": "compatibility_exception"
    },
    {
      "threat_class": "version_skew",
      "validation_gate": "view-layer-threat-gate",
      "generator_variant": "view_unsupported_contract_version",
      "seed": 3102,
      "expected_failure_mode": "fail_closed_version_skew",
      "replay_command": "python3 scripts/run_adversarial_seed_harness.py --threat-class version_skew --packet-id FNX-P2C-002 --run-id replay-528c16e08fb33323",
      "triage_routing_policy": "compatibility_exception"
    },
    {
      "threat_class": "resource_exhaustion",
      "validation_gate": "view-layer-threat-gate",
      "generator_variant": "view_materialization_blowup",
      "seed": 4102,
      "expected_failure_mode": "fail_closed_budget_exceeded",
      "replay_command": "python3 scripts/run_adversarial_seed_harness.py --threat-class resource_exhaustion --packet-id FNX-P2C-002 --run-id replay-97db5bc3de9d2c7e",
      "triage_routing_policy": "known_risk_allowlist"
    },
    {
      "threat_class": "state_corruption",
      "validation_gate": "view-layer-threat-gate",
      "generator_variant": "view_cache_invalidation_break",
      "seed": 5102,
      "expected_failure_mode": "fail_closed_invariant_break",
      "replay_command": "python3 scripts/run_adversarial_seed_harness.py --threat-class state_corruption --packet-id FNX-P2C-002 --run-id replay-2282714c94ea09f0",
      "triage_routing_policy": "bug"
    }
  ],
  "rust_module_boundary_skeleton": [
    {
      "crate_module": "crates/fnx-classes::Graph",
      "public_seams": [
        "graph mutation/query APIs"
      ],
      "internal_seams": [
        "revision counters",
        "adjacency/index mutation internals"
      ],
      "contract_rows": [
        "FNX-P2C-002-C1",
        "FNX-P2C-002-C2",
        "FNX-P2C-002-C5"
      ],
      "threat_classes": [
        "parser_abuse",
        "state_corruption"
      ]
    },
    {
      "crate_module": "crates/fnx-views::GraphView/CachedSnapshotView",
      "public_seams": [
        "view projection/read APIs"
      ],
      "internal_seams": [
        "cache invalidation",
        "revision-cache coherence"
      ],
      "contract_rows": [
        "FNX-P2C-002-C1",
        "FNX-P2C-002-C2"
      ],
      "threat_classes": [
        "metadata_ambiguity",
        "state_corruption",
        "resource_exhaustion"
      ]
    },
    {
      "crate_module": "crates/fnx-dispatch::BackendRegistry",
      "public_seams": [
        "dispatch request/decision APIs"
      ],
      "internal_seams": [
        "route ranking",
        "backend hint normalization"
      ],
      "contract_rows": [
        "FNX-P2C-002-C3",
        "FNX-P2C-002-C5"
      ],
      "threat_classes": [
        "metadata_ambiguity",
        "version_skew"
      ]
    }
  ],
  "implementation_sequence": [
    {
      "step_id": "FNX-P2C-002-PLAN-1",
      "name": "Boundary freeze",
      "depends_on": [],
      "checkpoint": "C1-C5 row-to-module mapping frozen with fail-closed defaults",
      "verification_entrypoints": [
        "artifacts/phase2c/FNX-P2C-002/contract_table.md",
        "artifacts/phase2c/FNX-P2C-002/legacy_anchor_map.md"
      ]
    },
    {
      "step_id": "FNX-P2C-002-PLAN-2",
      "name": "Instrumentation seam wiring",
      "depends_on": [
        "FNX-P2C-002-PLAN-1"
      ],
      "checkpoint": "structured log/replay hooks attached at mutation/view/dispatch seams",
      "verification_entrypoints": [
        "artifacts/conformance/latest/generated_view_neighbors_strict_json.report.json",
        "artifacts/conformance/latest/telemetry_dependent_unblock_matrix_v1.json"
      ]
    },
    {
      "step_id": "FNX-P2C-002-PLAN-3",
      "name": "Verification stack execution",
      "depends_on": [
        "FNX-P2C-002-PLAN-2"
      ],
      "checkpoint": "unit/property/differential/e2e entrypoints linked and replayable",
      "verification_entrypoints": [
        "rch exec -- cargo test -p fnx-conformance --test phase2c_packet_readiness_gate -- --nocapture",
        "artifacts/phase2c/security/v1/adversarial_seed_ledger_v1.json"
      ]
    }
  ],
  "public_internal_api_boundaries": {
    "public": [
      "deterministic graph/view/dispatch interfaces",
      "packet fixture execution/report interfaces"
    ],
    "internal": [
      "cache invalidation and normalization internals",
      "recovery and route tie-break internals with deterministic audit"
    ],
    "state_ownership_transitions": [
      "Graph mutation -> revision increment -> view cache invalidation",
      "Dispatch resolution -> conversion/readwrite normalization -> conformance emission"
    ]
  },
  "instrumentation_hooks": [
    {
      "hook_id": "FNX-P2C-002-H1",
      "seam": "graph/view mutation boundary",
      "required_fields": [
        "fixture_id",
        "mode",
        "replay_command",
        "forensic_bundle_id"
      ]
    },
    {
      "hook_id": "FNX-P2C-002-H2",
      "seam": "dispatch decision boundary",
      "required_fields": [
        "reason_code",
        "env_fingerprint",
        "forensics_bundle_index.bundle_hash_id"
      ]
    }
  ],
  "compatibility_risks": [
    "stale cache exposure",
    "projection filter nondeterminism"
  ],
  "raptorq_artifacts": {
    "legacy_anchor_map": "artifacts/phase2c/FNX-P2C-002/legacy_anchor_map.md",
    "contract_table": "artifacts/phase2c/FNX-P2C-002/contract_table.md",
    "fixture_manifest": "artifacts/phase2c/FNX-P2C-002/fixture_manifest.json",
    "parity_gate": "artifacts/phase2c/FNX-P2C-002/parity_gate.yaml",
    "risk_note": "artifacts/phase2c/FNX-P2C-002/risk_note.md",
    "parity_report": "artifacts/phase2c/FNX-P2C-002/parity_report.json",
    "raptorq_sidecar": "artifacts/phase2c/FNX-P2C-002/parity_report.raptorq.json",
    "decode_proof": "artifacts/phase2c/FNX-P2C-002/parity_report.decode_proof.json"
  }
}
